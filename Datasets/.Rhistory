##------ Tue Mar 10 07:48:12 2020 ------##
library(readxl)
library(writexl)
data(cars)
cars
write_xlsx(cars, path="cars.xlsx")
data(mtcars)
mtcars
write_xlsx(mtcars, path="mtcars.xlsx")
library(tidyverse)
mtcars <- data.frame(model=colnames(mtcars), mtcars)
class(mtcars)
mtcars <- data.frame(model=rownames(mtcars), mtcars)
mtcars
write_xlsx(mtcars, path="mtcars.xlsx")
library(tmod)
data(tmod)
?tmod
data(modmetabo)
modmetabo
modmetabo$MODULES
lapply(modmetabo$MODULES2GENES, length)
sel <- lapply(modmetabo$MODULES2GENES, length) < 12 & lapply(modmetabo$MODULES2GENES, length) > 4
sum(sel)
foo <- modmetabo[sel]
foo
foo$MODULES2GENES
?write_xlsx
modmetabo$GENES
write_xlsx(list(metabolites=foo$GENES, modules=foo$
lapply(foo$MODULES2GENES, function(x) paste(x, collapse=";"))
unlist(lapply(foo$MODULES2GENES, function(x) paste(x, collapse=";")))
mods <- unlist(lapply(foo$MODULES2GENES, function(x) paste(x, collapse=";")))
names(mods)
foo$MODULES
mods <- data.frame(foo$MODULES, compounds=mods)
mods
write_xlsx(list(metabolites=foo$GENES, modules=mods), path="metabolic_modules.xlsx")
library(readxl)
foo <- read_xlsx("cars.xlsx")
foo
foo[,1]
foo[,1,drop=T]
as.data.frame(foo)[,1]
??setosa
data(iris)
iris
write.csv(iris, "iris.csv")
write.csv(mtcars, "mtcars_wide.csv")
m <- matrix(rnorm(100), ncol=10, nrow=10)
m
m[1,]
m[,1]
m <- matrix(1:18, ncol=3, nrow=6)
m
m <- matrix(1:18, ncol=3, nrow=6, byrow=T)
m
dim(m)
ncol(m)
m[,1:4]
names <- c("January", "Bill")
lastn <- c("Weiner", "Gates")
age   <- c(1001, 64)
d <- data.frame(names=names, last_names=lastn, age=age)
d
class(d[,1])
group <- c("Control", " control", "control ", "Control   ")
group <- gsub("Control", "control", group)
group <- gsub(" ", "", group)
group
?read_xlsx
?excel_format
     files <- c(
       "a.xlsx",
       "b.xls",
       "c.png",
       file.path(R.home("doc"), "html", "logo.jpg"),
       readxl_example("clippy.xlsx"),
       readxl_example("deaths.xls")
     )
     excel_format(files)
 readxl_example("deaths.xls")
foo <- readxl( readxl_example("deaths.xls"))
foo <- read_xls( readxl_example("deaths.xls"))
foo
read_xlsx(readxl_example("clippy.xlsx"))
?read_xlsx
read_xlsx(readxl_example("clippy.xlsx"), skip=4)
foo <- read_xls( readxl_example("deaths.xls"), skip=4)
foo
foo <- read_xls( readxl_example("deaths.xls"), skip=4, max=10)
?read_xls
foo <- read_xls( readxl_example("deaths.xls"), skip=4, n_max=10)
foo
class(foo[, "Date of death"])
class(as.data.frame(foo)[, "Date of death"])
wide <- read.table(header=TRUE, text='
 subject sex control cond1 cond2
       1   M     7.9  12.3  10.7
       2   F     6.3  10.6  11.1
       3   F     9.5  13.1  13.8
       4   M    11.5  13.4  12.9
')
wide
?gather
gather
library(tidyr)
gather(data, key="condition", value="measurement",  convert=control:cond2)
gather(wide, key="condition", value="measurement",  convert=control:cond2)
wide
gather(wide, key="condition", value="measurement",  control:cond2)
class(gather(wide, key="condition", value="measurement",  control:cond2))
install.packages("rlang")
##------ Tue Mar 10 11:46:54 2020 ------##
long <- read.table(header=TRUE, text='
 subject  sampleID sex condition measurement
       1  ID000001 M   control         7.9
       1  ID000002 M     cond1        12.3
       1  ID000003 M     cond2        10.7
       2  ID000004 F   control         6.3
       2  ID000005 F     cond1        10.6
       2  ID000006 F     cond2        11.1
       3  ID000007 F   control         9.5
       3  ID000008 F     cond1        13.1
       3  ID000009 F     cond2        13.8
')
library(tidyr)
long
spread(long, key="condition", value="measurement")
